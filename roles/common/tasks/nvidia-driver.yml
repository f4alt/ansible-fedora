- name: Install RPM Fusion free and nonfree repositories
  dnf:
    name:
      - "https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-40.noarch.rpm"
      - "https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-40.noarch.rpm"
    state: present
    disable_gpg_check: yes

- name: Install nvidia packages
  dnf:
    name:
      - kernel-headers 
      - kernel-devel
      - akmod-nvidia
      - xorg-x11-drv-nvidia
      - xorg-x11-drv-nvidia-libs
    state: present

- name: Compile kernel modules
  command: akmods --force
